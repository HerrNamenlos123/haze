
test_match_compile_time() {
    let r = r"\w+";

    assert(regex.match(r, "hello") == true);
    assert(regex.match(r, "hello world") == true);
    assert(regex.match(r, "!!!") == false);
}

test_runtime_compile() {
    let ok = regex.runtime("[a-z]+", "");
    assert(ok.isOk());

    let r = ok.unwrap();
    assert(regex.match(r, "abc") == true);
    assert(regex.match(r, "123") == false);

    let err = regex.runtime("(", "");
    assert(err.isErr());
}

test_find() {
    let r = r"world";
    let text = "hello world!";

    let m = regex.find(r, text);
    assert(m != none);

    let match = m!;
    assert(match.start == 6);
    assert(match.end == 11);

    let slice = text[match.start .. match.end];
    assert(slice == "world");
}

test_find_none() {
    let r = r"\d+";
    let text = "abc";

    let m = regex.find(r, text);
    assert(m == none);
}

test_find_all() {
    let r = r"\d+";
    let text = "a1 b22 c333";

    let matches = regex.findAll(r, text);

    assert(matches.length == 3);

    assert(text[matches[0].start .. matches[0].end] == "1");
    assert(text[matches[1].start .. matches[1].end] == "22");
    assert(text[matches[2].start .. matches[2].end] == "333");
}

test_zero_length() {
    let r = r"^";
    let text = "abc";

    let matches = regex.findAll(r, text);

    assert(matches.length == 1);
    assert(matches[0].start == 0);
    assert(matches[0].end == 0);
}

test_replace_global() {
    let r = r"\s+";
    let text = "a   b    c";

    let out = regex.replace(r, text, " ");
    assert(out == "a b c");
}

test_replace_no_match() {
    let r = r"\d+";
    let text = "abc";

    let out = regex.replace(r, text, "X");
    assert(out == "abc");
}

test_compile_and_runtime_mix() {
    let r1 = r"[a-z]+";
    let r2 = regex.runtime("[A-Z]+", "").unwrap();

    let text = "abc DEF";

    assert(regex.match(r1, text));
    assert(regex.match(r2, text));
}

test_regex() {
    test_match_compile_time();
    test_runtime_compile();
    test_find();
    test_find_none();
    test_find_all();
    test_zero_length();
    test_replace_global();
    test_replace_no_match();
    test_compile_and_runtime_mix();

    print("All regex tests passed.");
}
